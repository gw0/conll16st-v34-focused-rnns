[2016-05-07 19:10] configuration (/srv/ex/conll16st-v3403-8c72dacfe3cce1d3f8889ccdbe197993)
[2016-05-07 19:10]     config 'epochs': 200 (1000)
[2016-05-07 19:10]     config 'epochs_len': -1 (-1)
[2016-05-07 19:10]     config 'epochs_patience': 10 (10)
[2016-05-07 19:10]     config 'batch_size':  (64)
[2016-05-07 19:10]     config 'snapshot_size':  (2048)
[2016-05-07 19:10]     config 'random_per_sample': 24.0 (1)
[2016-05-07 19:10]     config 'filter_fn_name': conn_eq_0 (conn_eq_0)
[2016-05-07 19:10]   args.experiment_dir: /srv/ex/conll16st-v3403-8c72dacfe3cce1d3f8889ccdbe197993
[2016-05-07 19:10]   args.train_dir: /srv/data/conll16st-en-train
[2016-05-07 19:10]   args.valid_dir: /srv/data/conll16st-en-dev
[2016-05-07 19:10]   K._config: {'epsilon': 1e-07, 'floatx': 'float32', 'backend': 'theano'}
[2016-05-07 19:10]   os.getenv("THEANO_FLAGS"): None
[2016-05-07 19:10]   filter_types: None
[2016-05-07 19:10]   config: {u'words2vec_bin': None, u'words_dim': 30.0, u'filter_fn_name': u'conn_eq_0', u'focus_dim': 4.0, u'random_per_sample': 24.0, u'final_dropout': 0.24878656948455835, u'epochs': 200, u'words2vec_txt': None, u'focus_dropout_W': 0.25784054169764664, u'rnn_dim': 10.0, u'focus_dropout_U': 0.09393246810927378, u'epochs_len': -1, u'final_dim': 90.0, u'epochs_patience': 10, u'rnn_dropout_W': 0.785766008710069, u'words_dropout': 0.0767286069844771, u'rnn_dropout_U': 0.003166137118741419}
[2016-05-07 19:10] load dataset for training (/srv/data/conll16st-en-train)
[2016-05-07 19:13]   /srv/data/conll16st-en-train: doc_ids: 1756, words: 933049, rel_ids: 15246, relation tokens: 482545
[2016-05-07 19:13] load dataset for validation (/srv/data/conll16st-en-dev)
[2016-05-07 19:13]   /srv/data/conll16st-en-dev: doc_ids: 79, words: 39712, rel_ids: 699, relation tokens: 20137
[2016-05-07 19:13] build indexes
[2016-05-07 19:13]   rel_senses2id: 21, words2id: 43918
[2016-05-07 19:13] build model
[2016-05-07 19:13]     config 'words_dim': 30.0 (20)
[2016-05-07 19:13]     config 'focus_dim': 4.0 (4)
[2016-05-07 19:13]     config 'rnn_dim': 10.0 (20)
[2016-05-07 19:13]     config 'final_dim': 90.0 (40)
[2016-05-07 19:13]     config 'arg1_len':  (100)
[2016-05-07 19:13]     config 'arg2_len':  (100)
[2016-05-07 19:13]     config 'conn_len':  (10)
[2016-05-07 19:13]     config 'punc_len':  (2)
[2016-05-07 19:13]     config 'words_dropout': 0.0767286069845 (0.33)
[2016-05-07 19:13]     config 'focus_dropout_W': 0.257840541698 (0.33)
[2016-05-07 19:13]     config 'focus_dropout_U': 0.0939324681093 (0.66)
[2016-05-07 19:13]     config 'rnn_dropout_W': 0.78576600871 (0.33)
[2016-05-07 19:13]     config 'rnn_dropout_U': 0.00316613711874 (0.66)
[2016-05-07 19:13]     config 'final_dropout': 0.248786569485 (0.5)
[2016-05-07 19:13]     config 'words2vec_bin': None (None)
[2016-05-07 19:13]     config 'words2vec_txt': None (None)
[2016-05-07 19:14]     config 'rsenses_imp_loss':  (categorical_crossentropy)
____________________________________________________________________________________________________
Layer (type)                       Output Shape        Param #     Connected to                     
====================================================================================================
arg1_ids (InputLayer)              (None, 100)         0                                            
____________________________________________________________________________________________________
arg2_ids (InputLayer)              (None, 100)         0                                            
____________________________________________________________________________________________________
conn_ids (InputLayer)              (None, 10)          0                                            
____________________________________________________________________________________________________
punc_ids (InputLayer)              (None, 2)           0                                            
____________________________________________________________________________________________________
shared_emb (Embedding)             multiple            1317540     arg1_ids[0][0]                   
                                                                   arg2_ids[0][0]                   
                                                                   conn_ids[0][0]                   
                                                                   punc_ids[0][0]                   
____________________________________________________________________________________________________
gru_1 (GRU)                        (None, 100, 4)      420         shared_emb[0][0]                 
____________________________________________________________________________________________________
gru_11 (GRU)                       (None, 10, 4)       420         shared_emb[2][0]                 
____________________________________________________________________________________________________
gru_16 (GRU)                       (None, 2, 4)        420         shared_emb[3][0]                 
____________________________________________________________________________________________________
gru_6 (GRU)                        (None, 100, 4)      420         shared_emb[1][0]                 
____________________________________________________________________________________________________
timedistributed_1 (TimeDistributed)(None, 100, 30)     0           gru_1[0][0]                      
____________________________________________________________________________________________________
timedistributed_10 (TimeDistributed(None, 10, 30)      0           gru_11[0][0]                     
____________________________________________________________________________________________________
timedistributed_11 (TimeDistributed(None, 10, 30)      0           gru_11[0][0]                     
____________________________________________________________________________________________________
timedistributed_12 (TimeDistributed(None, 10, 30)      0           gru_11[0][0]                     
____________________________________________________________________________________________________
timedistributed_13 (TimeDistributed(None, 2, 30)       0           gru_16[0][0]                     
____________________________________________________________________________________________________
timedistributed_14 (TimeDistributed(None, 2, 30)       0           gru_16[0][0]                     
____________________________________________________________________________________________________
timedistributed_15 (TimeDistributed(None, 2, 30)       0           gru_16[0][0]                     
____________________________________________________________________________________________________
timedistributed_16 (TimeDistributed(None, 2, 30)       0           gru_16[0][0]                     
____________________________________________________________________________________________________
timedistributed_2 (TimeDistributed)(None, 100, 30)     0           gru_1[0][0]                      
____________________________________________________________________________________________________
timedistributed_3 (TimeDistributed)(None, 100, 30)     0           gru_1[0][0]                      
____________________________________________________________________________________________________
timedistributed_4 (TimeDistributed)(None, 100, 30)     0           gru_1[0][0]                      
____________________________________________________________________________________________________
timedistributed_5 (TimeDistributed)(None, 100, 30)     0           gru_6[0][0]                      
____________________________________________________________________________________________________
timedistributed_6 (TimeDistributed)(None, 100, 30)     0           gru_6[0][0]                      
____________________________________________________________________________________________________
timedistributed_7 (TimeDistributed)(None, 100, 30)     0           gru_6[0][0]                      
____________________________________________________________________________________________________
timedistributed_8 (TimeDistributed)(None, 100, 30)     0           gru_6[0][0]                      
____________________________________________________________________________________________________
timedistributed_9 (TimeDistributed)(None, 10, 30)      0           gru_11[0][0]                     
____________________________________________________________________________________________________
merge_1 (Merge)                    (None, 100, 30)     0           shared_emb[0][0]                 
                                                                   timedistributed_1[0][0]          
____________________________________________________________________________________________________
merge_10 (Merge)                   (None, 10, 30)      0           shared_emb[2][0]                 
                                                                   timedistributed_10[0][0]         
____________________________________________________________________________________________________
merge_11 (Merge)                   (None, 10, 30)      0           shared_emb[2][0]                 
                                                                   timedistributed_11[0][0]         
____________________________________________________________________________________________________
merge_12 (Merge)                   (None, 10, 30)      0           shared_emb[2][0]                 
                                                                   timedistributed_12[0][0]         
____________________________________________________________________________________________________
merge_13 (Merge)                   (None, 2, 30)       0           shared_emb[3][0]                 
                                                                   timedistributed_13[0][0]         
____________________________________________________________________________________________________
merge_14 (Merge)                   (None, 2, 30)       0           shared_emb[3][0]                 
                                                                   timedistributed_14[0][0]         
____________________________________________________________________________________________________
merge_15 (Merge)                   (None, 2, 30)       0           shared_emb[3][0]                 
                                                                   timedistributed_15[0][0]         
____________________________________________________________________________________________________
merge_16 (Merge)                   (None, 2, 30)       0           shared_emb[3][0]                 
                                                                   timedistributed_16[0][0]         
____________________________________________________________________________________________________
merge_2 (Merge)                    (None, 100, 30)     0           shared_emb[0][0]                 
                                                                   timedistributed_2[0][0]          
____________________________________________________________________________________________________
merge_3 (Merge)                    (None, 100, 30)     0           shared_emb[0][0]                 
                                                                   timedistributed_3[0][0]          
____________________________________________________________________________________________________
merge_4 (Merge)                    (None, 100, 30)     0           shared_emb[0][0]                 
                                                                   timedistributed_4[0][0]          
____________________________________________________________________________________________________
merge_5 (Merge)                    (None, 100, 30)     0           shared_emb[1][0]                 
                                                                   timedistributed_5[0][0]          
____________________________________________________________________________________________________
merge_6 (Merge)                    (None, 100, 30)     0           shared_emb[1][0]                 
                                                                   timedistributed_6[0][0]          
____________________________________________________________________________________________________
merge_7 (Merge)                    (None, 100, 30)     0           shared_emb[1][0]                 
                                                                   timedistributed_7[0][0]          
____________________________________________________________________________________________________
merge_8 (Merge)                    (None, 100, 30)     0           shared_emb[1][0]                 
                                                                   timedistributed_8[0][0]          
____________________________________________________________________________________________________
merge_9 (Merge)                    (None, 10, 30)      0           shared_emb[2][0]                 
                                                                   timedistributed_9[0][0]          
____________________________________________________________________________________________________
gru_10 (GRU)                       (None, 10)          1230        merge_8[0][0]                    
____________________________________________________________________________________________________
gru_12 (GRU)                       (None, 10)          1230        merge_9[0][0]                    
____________________________________________________________________________________________________
gru_13 (GRU)                       (None, 10)          1230        merge_10[0][0]                   
____________________________________________________________________________________________________
gru_14 (GRU)                       (None, 10)          1230        merge_11[0][0]                   
____________________________________________________________________________________________________
gru_15 (GRU)                       (None, 10)          1230        merge_12[0][0]                   
____________________________________________________________________________________________________
gru_17 (GRU)                       (None, 10)          1230        merge_13[0][0]                   
____________________________________________________________________________________________________
gru_18 (GRU)                       (None, 10)          1230        merge_14[0][0]                   
____________________________________________________________________________________________________
gru_19 (GRU)                       (None, 10)          1230        merge_15[0][0]                   
____________________________________________________________________________________________________
gru_2 (GRU)                        (None, 10)          1230        merge_1[0][0]                    
____________________________________________________________________________________________________
gru_20 (GRU)                       (None, 10)          1230        merge_16[0][0]                   
____________________________________________________________________________________________________
gru_3 (GRU)                        (None, 10)          1230        merge_2[0][0]                    
____________________________________________________________________________________________________
gru_4 (GRU)                        (None, 10)          1230        merge_3[0][0]                    
____________________________________________________________________________________________________
gru_5 (GRU)                        (None, 10)          1230        merge_4[0][0]                    
____________________________________________________________________________________________________
gru_7 (GRU)                        (None, 10)          1230        merge_5[0][0]                    
____________________________________________________________________________________________________
gru_8 (GRU)                        (None, 10)          1230        merge_6[0][0]                    
____________________________________________________________________________________________________
gru_9 (GRU)                        (None, 10)          1230        merge_7[0][0]                    
____________________________________________________________________________________________________
merge_17 (Merge)                   (None, 160)         0           gru_2[0][0]                      
                                                                   gru_3[0][0]                      
                                                                   gru_4[0][0]                      
                                                                   gru_5[0][0]                      
                                                                   gru_7[0][0]                      
                                                                   gru_8[0][0]                      
                                                                   gru_9[0][0]                      
                                                                   gru_10[0][0]                     
                                                                   gru_12[0][0]                     
                                                                   gru_13[0][0]                     
                                                                   gru_14[0][0]                     
                                                                   gru_15[0][0]                     
                                                                   gru_17[0][0]                     
                                                                   gru_18[0][0]                     
                                                                   gru_19[0][0]                     
                                                                   gru_20[0][0]                     
____________________________________________________________________________________________________
dense_1 (Dense)                    (None, 90)          14490       merge_17[0][0]                   
____________________________________________________________________________________________________
srelu_1 (SReLU)                    (None, 90)          360         dense_1[0][0]                    
____________________________________________________________________________________________________
dropout_1 (Dropout)                (None, 90)          0           srelu_1[0][0]                    
____________________________________________________________________________________________________
dense_2 (Dense)                    (None, 21)          1911        dropout_1[0][0]                  
____________________________________________________________________________________________________
rsenses_imp (Activation)           (None, 21)          0           dense_2[0][0]                    
====================================================================================================
Total params: 1355661
____________________________________________________________________________________________________
[2016-05-07 19:14]     config 'optimizer':  (adam)
[2016-05-07 19:14] initialize weights
[2016-05-07 19:14] prepare snapshots
[2016-05-07 19:14] train model
Epoch 1/200
/usr/local/lib/python2.7/dist-packages/keras/engine/training.py:1397: UserWarning: Epoch comprised more than `samples_per_epoch` samples, which might affect learning results. Set `samples_per_epoch` correctly to avoid this warning.
  warnings.warn('Epoch comprised more than '
78s - loss: 0.3759 - acc: 0.9633 - val_loss: 2.2413 - val_acc: 0.2675
Epoch 2/200
77s - loss: 0.0943 - acc: 0.9693 - val_loss: 2.2139 - val_acc: 0.2690
Epoch 3/200
77s - loss: 0.0878 - acc: 0.9722 - val_loss: 1.8758 - val_acc: 0.4649
Epoch 4/200
77s - loss: 0.0709 - acc: 0.9782 - val_loss: 1.5587 - val_acc: 0.5336
Epoch 5/200
77s - loss: 0.0646 - acc: 0.9805 - val_loss: 1.2890 - val_acc: 0.5765
Epoch 6/200
77s - loss: 0.0610 - acc: 0.9811 - val_loss: 1.1419 - val_acc: 0.6824
Epoch 7/200
77s - loss: 0.0559 - acc: 0.9833 - val_loss: 1.0845 - val_acc: 0.7310
Epoch 8/200
78s - loss: 0.0521 - acc: 0.9844 - val_loss: 0.9707 - val_acc: 0.7468
Epoch 9/200
78s - loss: 0.0481 - acc: 0.9851 - val_loss: 0.9365 - val_acc: 0.7754
Epoch 10/200
78s - loss: 0.0493 - acc: 0.9852 - val_loss: 0.8603 - val_acc: 0.7740
Epoch 11/200
78s - loss: 0.0511 - acc: 0.9843 - val_loss: 0.8553 - val_acc: 0.7468
Epoch 12/200
78s - loss: 0.0404 - acc: 0.9885 - val_loss: 0.7661 - val_acc: 0.8240
Epoch 13/200
78s - loss: 0.0433 - acc: 0.9868 - val_loss: 0.7280 - val_acc: 0.8212
Epoch 14/200
78s - loss: 0.0435 - acc: 0.9874 - val_loss: 0.7361 - val_acc: 0.8312
Epoch 15/200
78s - loss: 0.0444 - acc: 0.9868 - val_loss: 0.6993 - val_acc: 0.8269
Epoch 16/200
78s - loss: 0.0401 - acc: 0.9879 - val_loss: 0.7281 - val_acc: 0.8112
Epoch 17/200
78s - loss: 0.0443 - acc: 0.9871 - val_loss: 0.6411 - val_acc: 0.8369
Epoch 18/200
78s - loss: 0.0370 - acc: 0.9890 - val_loss: 0.6706 - val_acc: 0.8355
Epoch 19/200
78s - loss: 0.0402 - acc: 0.9875 - val_loss: 0.6258 - val_acc: 0.8369
Epoch 20/200
78s - loss: 0.0425 - acc: 0.9863 - val_loss: 0.6553 - val_acc: 0.8183
Epoch 21/200
78s - loss: 0.0371 - acc: 0.9885 - val_loss: 0.6118 - val_acc: 0.8312
Epoch 22/200
78s - loss: 0.0386 - acc: 0.9881 - val_loss: 0.6096 - val_acc: 0.8355
Epoch 23/200
78s - loss: 0.0366 - acc: 0.9889 - val_loss: 0.6310 - val_acc: 0.8269
Epoch 24/200
78s - loss: 0.0365 - acc: 0.9890 - val_loss: 0.6303 - val_acc: 0.8355
Epoch 25/200
78s - loss: 0.0362 - acc: 0.9886 - val_loss: 0.6415 - val_acc: 0.8326
Epoch 26/200
78s - loss: 0.0378 - acc: 0.9878 - val_loss: 0.6232 - val_acc: 0.8283
Epoch 27/200
78s - loss: 0.0350 - acc: 0.9891 - val_loss: 0.6432 - val_acc: 0.8312
Epoch 28/200
78s - loss: 0.0342 - acc: 0.9898 - val_loss: 0.5896 - val_acc: 0.8412
Epoch 29/200
78s - loss: 0.0363 - acc: 0.9881 - val_loss: 0.5901 - val_acc: 0.8455
Epoch 30/200
78s - loss: 0.0362 - acc: 0.9890 - val_loss: 0.5831 - val_acc: 0.8369
Epoch 31/200
78s - loss: 0.0366 - acc: 0.9886 - val_loss: 0.5848 - val_acc: 0.8398
Epoch 32/200
78s - loss: 0.0338 - acc: 0.9895 - val_loss: 0.6117 - val_acc: 0.8240
Epoch 33/200
78s - loss: 0.0344 - acc: 0.9897 - val_loss: 0.5905 - val_acc: 0.8340
Epoch 34/200
78s - loss: 0.0373 - acc: 0.9881 - val_loss: 0.5892 - val_acc: 0.8298
Epoch 35/200
78s - loss: 0.0362 - acc: 0.9881 - val_loss: 0.5667 - val_acc: 0.8383
Epoch 36/200
78s - loss: 0.0369 - acc: 0.9883 - val_loss: 0.5746 - val_acc: 0.8340
Epoch 37/200
78s - loss: 0.0371 - acc: 0.9892 - val_loss: 0.5697 - val_acc: 0.8340
Epoch 38/200
78s - loss: 0.0351 - acc: 0.9887 - val_loss: 0.5865 - val_acc: 0.8369
Epoch 39/200
78s - loss: 0.0379 - acc: 0.9886 - val_loss: 0.5570 - val_acc: 0.8398
Epoch 40/200
78s - loss: 0.0337 - acc: 0.9902 - val_loss: 0.5352 - val_acc: 0.8455
Epoch 41/200
78s - loss: 0.0310 - acc: 0.9903 - val_loss: 0.5545 - val_acc: 0.8340
Epoch 42/200
78s - loss: 0.0356 - acc: 0.9885 - val_loss: 0.5616 - val_acc: 0.8469
Epoch 43/200
78s - loss: 0.0350 - acc: 0.9882 - val_loss: 0.5479 - val_acc: 0.8383
Epoch 44/200
78s - loss: 0.0376 - acc: 0.9881 - val_loss: 0.5420 - val_acc: 0.8355
Epoch 45/200
78s - loss: 0.0313 - acc: 0.9897 - val_loss: 0.5401 - val_acc: 0.8312
Epoch 46/200
79s - loss: 0.0334 - acc: 0.9892 - val_loss: 0.5550 - val_acc: 0.8469
Epoch 47/200
78s - loss: 0.0346 - acc: 0.9892 - val_loss: 0.5303 - val_acc: 0.8498
Epoch 48/200
79s - loss: 0.0336 - acc: 0.9897 - val_loss: 0.5544 - val_acc: 0.8312
Epoch 49/200
78s - loss: 0.0341 - acc: 0.9883 - val_loss: 0.5494 - val_acc: 0.8398
Epoch 50/200
78s - loss: 0.0329 - acc: 0.9889 - val_loss: 0.5271 - val_acc: 0.8426
Epoch 51/200
78s - loss: 0.0355 - acc: 0.9887 - val_loss: 0.5657 - val_acc: 0.8455
Epoch 52/200
78s - loss: 0.0306 - acc: 0.9908 - val_loss: 0.5405 - val_acc: 0.8441
Epoch 53/200
78s - loss: 0.0324 - acc: 0.9898 - val_loss: 0.5401 - val_acc: 0.8484
Epoch 54/200
79s - loss: 0.0295 - acc: 0.9911 - val_loss: 0.5403 - val_acc: 0.8426
Epoch 55/200
78s - loss: 0.0325 - acc: 0.9890 - val_loss: 0.5855 - val_acc: 0.8398
Epoch 56/200
78s - loss: 0.0340 - acc: 0.9892 - val_loss: 0.5329 - val_acc: 0.8426
Epoch 57/200
78s - loss: 0.0330 - acc: 0.9898 - val_loss: 0.5263 - val_acc: 0.8526
Epoch 58/200
78s - loss: 0.0319 - acc: 0.9891 - val_loss: 0.5386 - val_acc: 0.8441
Epoch 59/200
80s - loss: 0.0335 - acc: 0.9897 - val_loss: 0.5059 - val_acc: 0.8655
Epoch 60/200
78s - loss: 0.0359 - acc: 0.9890 - val_loss: 0.5574 - val_acc: 0.8283
Epoch 61/200
78s - loss: 0.0323 - acc: 0.9906 - val_loss: 0.5312 - val_acc: 0.8369
Epoch 62/200
78s - loss: 0.0337 - acc: 0.9892 - val_loss: 0.5229 - val_acc: 0.8584
Epoch 63/200
78s - loss: 0.0289 - acc: 0.9903 - val_loss: 0.5390 - val_acc: 0.8455
Epoch 64/200
78s - loss: 0.0328 - acc: 0.9906 - val_loss: 0.5138 - val_acc: 0.8555
Epoch 65/200
79s - loss: 0.0317 - acc: 0.9894 - val_loss: 0.5322 - val_acc: 0.8469
Epoch 66/200
78s - loss: 0.0322 - acc: 0.9894 - val_loss: 0.5212 - val_acc: 0.8526
Epoch 67/200
80s - loss: 0.0313 - acc: 0.9899 - val_loss: 0.5553 - val_acc: 0.8369
Epoch 68/200
79s - loss: 0.0307 - acc: 0.9902 - val_loss: 0.5208 - val_acc: 0.8526
Epoch 69/200
79s - loss: 0.0304 - acc: 0.9902 - val_loss: 0.5348 - val_acc: 0.8484
Epoch 70/200
79s - loss: 0.0275 - acc: 0.9917 - val_loss: 0.5443 - val_acc: 0.8569
[2016-05-07 20:54] training finished


{"acc": 0.99167213596281456, "loss": -0.86552217504667794, "val_acc_max": 0.86552217504667794, "val_loss_min": 0.50590751159174074, "status": "ok", "val_acc": 0.85693848260994121, "loss_": 0.027521834953007723, "val_loss": 0.54432339934320406}
