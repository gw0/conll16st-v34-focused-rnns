[2016-05-08 08:52] configuration (/srv/ex/conll16st-v3405-909ecb89038db38e07865a4a565b75e9)
[2016-05-08 08:52]     config 'epochs': 200 (1000)
[2016-05-08 08:52]     config 'epochs_len': -1 (-1)
[2016-05-08 08:52]     config 'epochs_patience': 10 (20)
[2016-05-08 08:52]     config 'batch_size':  (64)
[2016-05-08 08:52]     config 'snapshot_size':  (2048)
[2016-05-08 08:52]     config 'random_per_sample': 8.0 (32)
[2016-05-08 08:52]     config 'words_dim': 70.0 (20)
[2016-05-08 08:52]     config 'focus_dim': 5.0 (4)
[2016-05-08 08:52]     config 'rnn_dim': 30.0 (20)
[2016-05-08 08:52]     config 'final_dim': 90.0 (100)
[2016-05-08 08:52]     config 'arg1_len': 500 (100)
[2016-05-08 08:52]     config 'arg2_len': 500 (100)
[2016-05-08 08:52]     config 'conn_len':  (10)
[2016-05-08 08:52]     config 'punc_len':  (2)
[2016-05-08 08:52]     config 'words_dropout': 0.75 (0.1)
[2016-05-08 08:52]     config 'focus_dropout_W': 0.25 (0.33)
[2016-05-08 08:52]     config 'focus_dropout_U': 0.5 (0.66)
[2016-05-08 08:52]     config 'rnn_dropout_W': 1.0 (0.33)
[2016-05-08 08:52]     config 'rnn_dropout_U': 0.5 (0.33)
[2016-05-08 08:52]     config 'final_dropout': 0.5 (0.5)
[2016-05-08 08:52]     config 'filter_fn_name': conn_gt_0 (conn_eq_0)
[2016-05-08 08:52]     config 'words2vec_bin': None (None)
[2016-05-08 08:52]     config 'words2vec_txt': None (None)
[2016-05-08 08:52]   args.experiment_dir: /srv/ex/conll16st-v3405-909ecb89038db38e07865a4a565b75e9
[2016-05-08 08:52]   args.train_dir: /srv/data/conll16st-zh-train
[2016-05-08 08:52]   args.valid_dir: /srv/data/conll16st-zh-dev
[2016-05-08 08:52]   K._config: {'epsilon': 1e-07, 'floatx': 'float32', 'backend': 'theano'}
[2016-05-08 08:52]   os.getenv("THEANO_FLAGS"): None
[2016-05-08 08:52]   filter_types: None
[2016-05-08 08:52]   config: {u'words2vec_bin': None, u'words_dim': 70.0, u'filter_fn_name': u'conn_gt_0', u'focus_dim': 5.0, u'random_per_sample': 8.0, u'final_dropout': 0.5, u'arg1_len': 500, u'epochs': 200, u'words2vec_txt': None, u'arg2_len': 500, u'focus_dropout_W': 0.25, u'rnn_dim': 30.0, u'focus_dropout_U': 0.5, u'epochs_len': -1, u'final_dim': 90.0, u'epochs_patience': 10, u'rnn_dropout_W': 1.0, u'words_dropout': 0.75, u'rnn_dropout_U': 0.5}
[2016-05-08 08:52] load dataset for training (/srv/data/conll16st-zh-train)
[2016-05-08 08:52]   /srv/data/conll16st-zh-train: doc_ids: 455, words: 155827, rel_ids: 7795, relation tokens: 386402
[2016-05-08 08:52] load dataset for validation (/srv/data/conll16st-zh-dev)
[2016-05-08 08:52]   /srv/data/conll16st-zh-dev: doc_ids: 24, words: 6782, rel_ids: 301, relation tokens: 14180
[2016-05-08 08:52] build indexes
[2016-05-08 08:52]   rel_senses2id: 11, words2id: 14785
[2016-05-08 08:52] build model
[2016-05-08 08:52]     config 'rsenses_loss':  (categorical_crossentropy)
____________________________________________________________________________________________________
Layer (type)                       Output Shape        Param #     Connected to                     
====================================================================================================
arg1_ids (InputLayer)              (None, 500)         0                                            
____________________________________________________________________________________________________
arg2_ids (InputLayer)              (None, 500)         0                                            
____________________________________________________________________________________________________
conn_ids (InputLayer)              (None, 10)          0                                            
____________________________________________________________________________________________________
punc_ids (InputLayer)              (None, 2)           0                                            
____________________________________________________________________________________________________
shared_emb (Embedding)             multiple            1034950     arg1_ids[0][0]                   
                                                                   arg2_ids[0][0]                   
                                                                   conn_ids[0][0]                   
                                                                   punc_ids[0][0]                   
____________________________________________________________________________________________________
gru_1 (GRU)                        (None, 500, 5)      1140        shared_emb[0][0]                 
____________________________________________________________________________________________________
gru_13 (GRU)                       (None, 10, 5)       1140        shared_emb[2][0]                 
____________________________________________________________________________________________________
gru_19 (GRU)                       (None, 2, 5)        1140        shared_emb[3][0]                 
____________________________________________________________________________________________________
gru_7 (GRU)                        (None, 500, 5)      1140        shared_emb[1][0]                 
____________________________________________________________________________________________________
timedistributed_1 (TimeDistributed)(None, 500, 70)     0           gru_1[0][0]                      
____________________________________________________________________________________________________
timedistributed_10 (TimeDistributed(None, 500, 70)     0           gru_7[0][0]                      
____________________________________________________________________________________________________
timedistributed_11 (TimeDistributed(None, 10, 70)      0           gru_13[0][0]                     
____________________________________________________________________________________________________
timedistributed_12 (TimeDistributed(None, 10, 70)      0           gru_13[0][0]                     
____________________________________________________________________________________________________
timedistributed_13 (TimeDistributed(None, 10, 70)      0           gru_13[0][0]                     
____________________________________________________________________________________________________
timedistributed_14 (TimeDistributed(None, 10, 70)      0           gru_13[0][0]                     
____________________________________________________________________________________________________
timedistributed_15 (TimeDistributed(None, 10, 70)      0           gru_13[0][0]                     
____________________________________________________________________________________________________
timedistributed_16 (TimeDistributed(None, 2, 70)       0           gru_19[0][0]                     
____________________________________________________________________________________________________
timedistributed_17 (TimeDistributed(None, 2, 70)       0           gru_19[0][0]                     
____________________________________________________________________________________________________
timedistributed_18 (TimeDistributed(None, 2, 70)       0           gru_19[0][0]                     
____________________________________________________________________________________________________
timedistributed_19 (TimeDistributed(None, 2, 70)       0           gru_19[0][0]                     
____________________________________________________________________________________________________
timedistributed_2 (TimeDistributed)(None, 500, 70)     0           gru_1[0][0]                      
____________________________________________________________________________________________________
timedistributed_20 (TimeDistributed(None, 2, 70)       0           gru_19[0][0]                     
____________________________________________________________________________________________________
timedistributed_3 (TimeDistributed)(None, 500, 70)     0           gru_1[0][0]                      
____________________________________________________________________________________________________
timedistributed_4 (TimeDistributed)(None, 500, 70)     0           gru_1[0][0]                      
____________________________________________________________________________________________________
timedistributed_5 (TimeDistributed)(None, 500, 70)     0           gru_1[0][0]                      
____________________________________________________________________________________________________
timedistributed_6 (TimeDistributed)(None, 500, 70)     0           gru_7[0][0]                      
____________________________________________________________________________________________________
timedistributed_7 (TimeDistributed)(None, 500, 70)     0           gru_7[0][0]                      
____________________________________________________________________________________________________
timedistributed_8 (TimeDistributed)(None, 500, 70)     0           gru_7[0][0]                      
____________________________________________________________________________________________________
timedistributed_9 (TimeDistributed)(None, 500, 70)     0           gru_7[0][0]                      
____________________________________________________________________________________________________
merge_1 (Merge)                    (None, 500, 70)     0           shared_emb[0][0]                 
                                                                   timedistributed_1[0][0]          
____________________________________________________________________________________________________
merge_10 (Merge)                   (None, 500, 70)     0           shared_emb[1][0]                 
                                                                   timedistributed_10[0][0]         
____________________________________________________________________________________________________
merge_11 (Merge)                   (None, 10, 70)      0           shared_emb[2][0]                 
                                                                   timedistributed_11[0][0]         
____________________________________________________________________________________________________
merge_12 (Merge)                   (None, 10, 70)      0           shared_emb[2][0]                 
                                                                   timedistributed_12[0][0]         
____________________________________________________________________________________________________
merge_13 (Merge)                   (None, 10, 70)      0           shared_emb[2][0]                 
                                                                   timedistributed_13[0][0]         
____________________________________________________________________________________________________
merge_14 (Merge)                   (None, 10, 70)      0           shared_emb[2][0]                 
                                                                   timedistributed_14[0][0]         
____________________________________________________________________________________________________
merge_15 (Merge)                   (None, 10, 70)      0           shared_emb[2][0]                 
                                                                   timedistributed_15[0][0]         
____________________________________________________________________________________________________
merge_16 (Merge)                   (None, 2, 70)       0           shared_emb[3][0]                 
                                                                   timedistributed_16[0][0]         
____________________________________________________________________________________________________
merge_17 (Merge)                   (None, 2, 70)       0           shared_emb[3][0]                 
                                                                   timedistributed_17[0][0]         
____________________________________________________________________________________________________
merge_18 (Merge)                   (None, 2, 70)       0           shared_emb[3][0]                 
                                                                   timedistributed_18[0][0]         
____________________________________________________________________________________________________
merge_19 (Merge)                   (None, 2, 70)       0           shared_emb[3][0]                 
                                                                   timedistributed_19[0][0]         
____________________________________________________________________________________________________
merge_2 (Merge)                    (None, 500, 70)     0           shared_emb[0][0]                 
                                                                   timedistributed_2[0][0]          
____________________________________________________________________________________________________
merge_20 (Merge)                   (None, 2, 70)       0           shared_emb[3][0]                 
                                                                   timedistributed_20[0][0]         
____________________________________________________________________________________________________
merge_3 (Merge)                    (None, 500, 70)     0           shared_emb[0][0]                 
                                                                   timedistributed_3[0][0]          
____________________________________________________________________________________________________
merge_4 (Merge)                    (None, 500, 70)     0           shared_emb[0][0]                 
                                                                   timedistributed_4[0][0]          
____________________________________________________________________________________________________
merge_5 (Merge)                    (None, 500, 70)     0           shared_emb[0][0]                 
                                                                   timedistributed_5[0][0]          
____________________________________________________________________________________________________
merge_6 (Merge)                    (None, 500, 70)     0           shared_emb[1][0]                 
                                                                   timedistributed_6[0][0]          
____________________________________________________________________________________________________
merge_7 (Merge)                    (None, 500, 70)     0           shared_emb[1][0]                 
                                                                   timedistributed_7[0][0]          
____________________________________________________________________________________________________
merge_8 (Merge)                    (None, 500, 70)     0           shared_emb[1][0]                 
                                                                   timedistributed_8[0][0]          
____________________________________________________________________________________________________
merge_9 (Merge)                    (None, 500, 70)     0           shared_emb[1][0]                 
                                                                   timedistributed_9[0][0]          
____________________________________________________________________________________________________
gru_10 (GRU)                       (None, 30)          9090        merge_8[0][0]                    
____________________________________________________________________________________________________
gru_11 (GRU)                       (None, 30)          9090        merge_9[0][0]                    
____________________________________________________________________________________________________
gru_12 (GRU)                       (None, 30)          9090        merge_10[0][0]                   
____________________________________________________________________________________________________
gru_14 (GRU)                       (None, 30)          9090        merge_11[0][0]                   
____________________________________________________________________________________________________
gru_15 (GRU)                       (None, 30)          9090        merge_12[0][0]                   
____________________________________________________________________________________________________
gru_16 (GRU)                       (None, 30)          9090        merge_13[0][0]                   
____________________________________________________________________________________________________
gru_17 (GRU)                       (None, 30)          9090        merge_14[0][0]                   
____________________________________________________________________________________________________
gru_18 (GRU)                       (None, 30)          9090        merge_15[0][0]                   
____________________________________________________________________________________________________
gru_2 (GRU)                        (None, 30)          9090        merge_1[0][0]                    
____________________________________________________________________________________________________
gru_20 (GRU)                       (None, 30)          9090        merge_16[0][0]                   
____________________________________________________________________________________________________
gru_21 (GRU)                       (None, 30)          9090        merge_17[0][0]                   
____________________________________________________________________________________________________
gru_22 (GRU)                       (None, 30)          9090        merge_18[0][0]                   
____________________________________________________________________________________________________
gru_23 (GRU)                       (None, 30)          9090        merge_19[0][0]                   
____________________________________________________________________________________________________
gru_24 (GRU)                       (None, 30)          9090        merge_20[0][0]                   
____________________________________________________________________________________________________
gru_3 (GRU)                        (None, 30)          9090        merge_2[0][0]                    
____________________________________________________________________________________________________
gru_4 (GRU)                        (None, 30)          9090        merge_3[0][0]                    
____________________________________________________________________________________________________
gru_5 (GRU)                        (None, 30)          9090        merge_4[0][0]                    
____________________________________________________________________________________________________
gru_6 (GRU)                        (None, 30)          9090        merge_5[0][0]                    
____________________________________________________________________________________________________
gru_8 (GRU)                        (None, 30)          9090        merge_6[0][0]                    
____________________________________________________________________________________________________
gru_9 (GRU)                        (None, 30)          9090        merge_7[0][0]                    
____________________________________________________________________________________________________
merge_21 (Merge)                   (None, 600)         0           gru_2[0][0]                      
                                                                   gru_3[0][0]                      
                                                                   gru_4[0][0]                      
                                                                   gru_5[0][0]                      
                                                                   gru_6[0][0]                      
                                                                   gru_8[0][0]                      
                                                                   gru_9[0][0]                      
                                                                   gru_10[0][0]                     
                                                                   gru_11[0][0]                     
                                                                   gru_12[0][0]                     
                                                                   gru_14[0][0]                     
                                                                   gru_15[0][0]                     
                                                                   gru_16[0][0]                     
                                                                   gru_17[0][0]                     
                                                                   gru_18[0][0]                     
                                                                   gru_20[0][0]                     
                                                                   gru_21[0][0]                     
                                                                   gru_22[0][0]                     
                                                                   gru_23[0][0]                     
                                                                   gru_24[0][0]                     
____________________________________________________________________________________________________
dense_1 (Dense)                    (None, 90)          54090       merge_21[0][0]                   
____________________________________________________________________________________________________
srelu_1 (SReLU)                    (None, 90)          360         dense_1[0][0]                    
____________________________________________________________________________________________________
dropout_1 (Dropout)                (None, 90)          0           srelu_1[0][0]                    
____________________________________________________________________________________________________
dense_2 (Dense)                    (None, 11)          1001        dropout_1[0][0]                  
____________________________________________________________________________________________________
rsenses (Activation)               (None, 11)          0           dense_2[0][0]                    
====================================================================================================
Total params: 1276761
____________________________________________________________________________________________________
[2016-05-08 08:53]     config 'optimizer':  (adam)
[2016-05-08 08:53] initialize weights
[2016-05-08 08:53] prepare snapshots
[2016-05-08 08:53] train model
Epoch 1/200
/usr/local/lib/python2.7/dist-packages/keras/engine/training.py:1397: UserWarning: Epoch comprised more than `samples_per_epoch` samples, which might affect learning results. Set `samples_per_epoch` correctly to avoid this warning.
  warnings.warn('Epoch comprised more than '
650s - loss: 0.6276 - acc: 0.8818 - val_loss: 2.1837 - val_acc: 0.0000e+00
Epoch 2/200
599s - loss: 0.1873 - acc: 0.9333 - val_loss: 1.1442 - val_acc: 0.6279
Epoch 3/200
623s - loss: 0.1359 - acc: 0.9580 - val_loss: 1.1061 - val_acc: 0.6279
Epoch 4/200
611s - loss: 0.1181 - acc: 0.9620 - val_loss: 1.0800 - val_acc: 0.6279
Epoch 5/200
637s - loss: 0.1209 - acc: 0.9599 - val_loss: 1.0153 - val_acc: 0.6279
Epoch 6/200
611s - loss: 0.1121 - acc: 0.9645 - val_loss: 1.0314 - val_acc: 0.6279
Epoch 7/200
563s - loss: 0.1165 - acc: 0.9615 - val_loss: 1.0544 - val_acc: 0.6279
Epoch 8/200
560s - loss: 0.1047 - acc: 0.9625 - val_loss: 0.9958 - val_acc: 0.6279
Epoch 9/200
529s - loss: 0.1155 - acc: 0.9590 - val_loss: 1.0050 - val_acc: 0.6279
Epoch 10/200
500s - loss: 0.1010 - acc: 0.9631 - val_loss: 0.9313 - val_acc: 0.6279
Epoch 11/200
485s - loss: 0.1210 - acc: 0.9562 - val_loss: 0.9773 - val_acc: 0.6279
Epoch 12/200
504s - loss: 0.1118 - acc: 0.9606 - val_loss: 0.9593 - val_acc: 0.6279
Epoch 13/200
479s - loss: 0.1039 - acc: 0.9626 - val_loss: 0.9361 - val_acc: 0.6711
Epoch 14/200
442s - loss: 0.1058 - acc: 0.9607 - val_loss: 0.9269 - val_acc: 0.6678
Epoch 15/200
439s - loss: 0.1054 - acc: 0.9610 - val_loss: 0.9239 - val_acc: 0.6611
Epoch 16/200
438s - loss: 0.1069 - acc: 0.9629 - val_loss: 0.9653 - val_acc: 0.6279
Epoch 17/200
442s - loss: 0.1031 - acc: 0.9644 - val_loss: 0.9242 - val_acc: 0.6678
Epoch 18/200
445s - loss: 0.0980 - acc: 0.9648 - val_loss: 0.8966 - val_acc: 0.6711
Epoch 19/200
436s - loss: 0.1019 - acc: 0.9624 - val_loss: 0.9101 - val_acc: 0.6545
Epoch 20/200
436s - loss: 0.1140 - acc: 0.9626 - val_loss: 0.9250 - val_acc: 0.6645
Epoch 21/200
436s - loss: 0.1001 - acc: 0.9638 - val_loss: 0.8913 - val_acc: 0.6777
Epoch 22/200
436s - loss: 0.1019 - acc: 0.9643 - val_loss: 0.9033 - val_acc: 0.6678
Epoch 23/200
432s - loss: 0.0971 - acc: 0.9622 - val_loss: 0.8984 - val_acc: 0.6711
Epoch 24/200
421s - loss: 0.0988 - acc: 0.9642 - val_loss: 0.8931 - val_acc: 0.6611
Epoch 25/200
411s - loss: 0.1007 - acc: 0.9634 - val_loss: 0.9305 - val_acc: 0.6678
Epoch 26/200
393s - loss: 0.0980 - acc: 0.9653 - val_loss: 0.9118 - val_acc: 0.6279
Epoch 27/200
395s - loss: 0.0978 - acc: 0.9650 - val_loss: 0.9294 - val_acc: 0.6312
Epoch 28/200
394s - loss: 0.1021 - acc: 0.9616 - val_loss: 0.8916 - val_acc: 0.6744
Epoch 29/200
396s - loss: 0.1012 - acc: 0.9659 - val_loss: 0.8888 - val_acc: 0.6777
Epoch 30/200
394s - loss: 0.1008 - acc: 0.9627 - val_loss: 0.8884 - val_acc: 0.6445
Epoch 31/200
392s - loss: 0.0998 - acc: 0.9640 - val_loss: 0.8999 - val_acc: 0.6744
Epoch 32/200
391s - loss: 0.0880 - acc: 0.9674 - val_loss: 0.9243 - val_acc: 0.6346
Epoch 33/200
395s - loss: 0.1014 - acc: 0.9652 - val_loss: 0.8964 - val_acc: 0.6478
Epoch 34/200
393s - loss: 0.0896 - acc: 0.9677 - val_loss: 0.8666 - val_acc: 0.6645
Epoch 35/200
395s - loss: 0.0966 - acc: 0.9643 - val_loss: 0.8871 - val_acc: 0.6777
Epoch 36/200
399s - loss: 0.0954 - acc: 0.9648 - val_loss: 0.8804 - val_acc: 0.6877
Epoch 37/200
395s - loss: 0.0884 - acc: 0.9656 - val_loss: 0.8825 - val_acc: 0.6645
Epoch 38/200
396s - loss: 0.0935 - acc: 0.9647 - val_loss: 0.8722 - val_acc: 0.6777
Epoch 39/200
397s - loss: 0.0924 - acc: 0.9649 - val_loss: 0.8972 - val_acc: 0.6645
Epoch 40/200
395s - loss: 0.0913 - acc: 0.9683 - val_loss: 0.8677 - val_acc: 0.6777
Epoch 41/200
397s - loss: 0.0881 - acc: 0.9686 - val_loss: 0.8724 - val_acc: 0.6811
Epoch 42/200
399s - loss: 0.0961 - acc: 0.9642 - val_loss: 0.8888 - val_acc: 0.6711
Epoch 43/200
396s - loss: 0.1021 - acc: 0.9638 - val_loss: 0.8798 - val_acc: 0.6910
Epoch 44/200
396s - loss: 0.0919 - acc: 0.9670 - val_loss: 0.8785 - val_acc: 0.6744
Epoch 45/200
401s - loss: 0.0982 - acc: 0.9657 - val_loss: 0.8794 - val_acc: 0.6478
[2016-05-08 14:44] training finished


{"acc": 0.96572375318052572, "loss": -0.69102990152035837, "val_acc_max": 0.69102990152035837, "val_loss_min": 0.86655295073391991, "status": "ok", "val_acc": 0.6478405327495943, "loss_": 0.098247598523462043, "epochs_len": 45, "acc_max": 0.96863799470086254, "loss_min": 0.087985957634725401, "val_loss": 0.87944192624963402}
